library (
  name = 'natives',
  flags = ['library'],
  libs = ['neutrino'],
  shared = True,
  files = [
    'core/file.cc',
    'test/test.cc'
  ],
)

flags (
  name = 'whiteout',
  include = ['library'],
  flags = {
    'LIBS': ['cairo'],
    'LIBPATH': '/opt/local/lib',
    'CPPPATH': [
      'natives',
      cond('os', {
        'darwin': ['/opt/local/include/cairo'],
        'linux': ['/usr/include/cairo']
      })
    ],
    'LINKFLAGS': [
      cond('os', {
        'darwin': ['-framework', 'Carbon'],
      })
    ],
  }
)

program (
  name = 'whiteout',
  flags = ['whiteout'],
  libs = ['neutrino'],
  files = [
    'whiteout/cairo-backend.cc',
    'whiteout/whiteout.cc',
    cond('os', {
        'darwin': ['whiteout/quartz-cairo-backend.cc'],
    }),
    'whiteout/wtk.cc'
  ],
)
